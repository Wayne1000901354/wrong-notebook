
[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90mD:/MyApp/wrong-notebook[39m

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥ç”Ÿæˆä¸­æ–‡æç¤ºè¯
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥ç”Ÿæˆè‹±æ–‡æç¤ºè¯
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥åŒ…å«å­¦ç§‘æç¤ºï¼ˆå¦‚æœæä¾›ï¼‰
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥æ ¹æ®å¹´çº§è¿‡æ»¤æ•°å­¦æ ‡ç­¾ï¼ˆåˆä¸€ï¼‰
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥æ ¹æ®å¹´çº§è¿‡æ»¤æ•°å­¦æ ‡ç­¾ï¼ˆåˆä¸‰ï¼‰
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥æ ¹æ®å¹´çº§è¿‡æ»¤æ•°å­¦æ ‡ç­¾ï¼ˆé«˜ä¸€ï¼‰
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥æ”¯æŒè‡ªå®šä¹‰é€‰é¡¹ (providerHints)
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2måº”è¯¥æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai-prompts.test.ts[2m > [22m[2mAI Prompts[2m > [22m[2mgenerateAnalyzePrompt[2m > [22m[2mç”Ÿæˆçš„æç¤ºè¯ä¸åº”åŒ…å«æœªæ›¿æ¢çš„å˜é‡å ä½ç¬¦
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

 [31mâ¯[39m src/__tests__/unit/ai-prompts.test.ts [2m([22m[2m25 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 16[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å¯¼å‡º DEFAULT_ANALYZE_TEMPLATE[32m 1[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å¯¼å‡º DEFAULT_SIMILAR_TEMPLATE[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å¯¼å‡º DEFAULT_REANSWER_TEMPLATE[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥ç”Ÿæˆä¸­æ–‡æç¤ºè¯[32m 1[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥ç”Ÿæˆè‹±æ–‡æç¤ºè¯[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m åº”è¯¥åŒ…å«å­¦ç§‘æç¤ºï¼ˆå¦‚æœæä¾›ï¼‰[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ ¹æ®å¹´çº§è¿‡æ»¤æ•°å­¦æ ‡ç­¾ï¼ˆåˆä¸€ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ ¹æ®å¹´çº§è¿‡æ»¤æ•°å­¦æ ‡ç­¾ï¼ˆåˆä¸‰ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ ¹æ®å¹´çº§è¿‡æ»¤æ•°å­¦æ ‡ç­¾ï¼ˆé«˜ä¸€ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ”¯æŒè‡ªå®šä¹‰é€‰é¡¹ (providerHints)[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿[32m 0[2mms[22m[39m
       [32mâœ“[39m ç”Ÿæˆçš„æç¤ºè¯ä¸åº”åŒ…å«æœªæ›¿æ¢çš„å˜é‡å ä½ç¬¦[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥ç”Ÿæˆä¸­æ–‡ç±»ä¼¼é¢˜æç¤ºè¯[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥ç”Ÿæˆè‹±æ–‡ç±»ä¼¼é¢˜æç¤ºè¯[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥åŒ…å«çŸ¥è¯†ç‚¹åˆ—è¡¨[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ ¹æ®éš¾åº¦çº§åˆ«è°ƒæ•´æç¤ºè¯[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ”¯æŒæ‰€æœ‰éš¾åº¦çº§åˆ«[32m 0[2mms[22m[39m
       [32mâœ“[39m é»˜è®¤éš¾åº¦åº”è¯¥æ˜¯ MEDIUM[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥ç”Ÿæˆä¸­æ–‡é‡æ–°è§£é¢˜æç¤ºè¯[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥ç”Ÿæˆè‹±æ–‡é‡æ–°è§£é¢˜æç¤ºè¯[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥åŒ…å«å­¦ç§‘æç¤ºï¼ˆå¦‚æœæä¾›ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ”¯æŒè‡ªå®šä¹‰ provider hints[32m 0[2mms[22m[39m
       [32mâœ“[39m ç”Ÿæˆçš„æç¤ºè¯ä¸åº”åŒ…å«æœªæ›¿æ¢çš„å˜é‡å ä½ç¬¦[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®å¤„ç†å¤šè¡Œæ–‡æœ¬[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®å¤„ç†ç‰¹æ®Šå­—ç¬¦[32m 0[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/logger.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 53[2mms[22m[39m
 [31mâ¯[39m src/__tests__/unit/grade-calculator.test.ts [2m([22m[2m26 tests[22m[2m | [22m[31m10 failed[39m[2m)[22m[32m 14[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹ä¸€ä¸Šå­¸æœŸï¼ˆ9æœˆå…¥å­¸ç•¶å¹´9æœˆï¼‰[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®è®¡ç®—åˆä¸€ä¸ŠæœŸï¼ˆè‹±æ–‡ï¼‰[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹ä¸€ä¸‹å­¸æœŸï¼ˆæ¬¡å¹´2æœˆï¼‰[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹äºŒä¸Šå­¸æœŸ[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹ä¸‰ä¸‹å­¸æœŸ[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè™•ç†å·²ç•¢æ¥­æƒ…æ³[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®å¤„ç†å·²æ¯•ä¸šæƒ…å†µï¼ˆè‹±æ–‡ï¼‰[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—é«˜ä¸€ä¸Šå­¸æœŸ[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—é«˜äºŒä¸‹å­¸æœŸ[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®è®¡ç®—é«˜ä¸‰ä¸ŠæœŸï¼ˆè‹±æ–‡ï¼‰[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—ä¸€å¹´ç´š[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—å…­å¹´ç´š[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®è®¡ç®—å…­å¹´çº§ï¼ˆè‹±æ–‡ï¼‰[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æ­£ç¢ºè¨ˆç®—å¤§ä¸€[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®è®¡ç®—å¤§å››ï¼ˆè‹±æ–‡ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m 9æœˆä»½æ‡‰è©²æ˜¯ä¸Šå­¸æœŸ[32m 0[2mms[22m[39m
       [32mâœ“[39m 12æœˆä»½æ‡‰è©²æ˜¯ä¸Šå­¸æœŸ[32m 0[2mms[22m[39m
       [32mâœ“[39m 1æœˆä»½æ‡‰è©²æ˜¯ä¸Šå­¸æœŸï¼ˆå¯’å‡å‰ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m 2æœˆä»½æ‡‰è©²æ˜¯ä¸‹å­¸æœŸ[32m 0[2mms[22m[39m
       [32mâœ“[39m 6æœˆä»½æ‡‰è©²æ˜¯ä¸‹å­¸æœŸ[32m 0[2mms[22m[39m
       [32mâœ“[39m 8æœˆä»½æ‡‰è©²æ˜¯ä¸‹å­¸æœŸï¼ˆæš‘å‡ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m æœªå…¥å­¸æƒ…æ³æ‡‰è¿”å›å­¸å‰[32m 0[2mms[22m[39m
       [32mâœ“[39m æœªå…¥å­¸æƒ…æ³æ‡‰è¿”å› Pre-schoolï¼ˆè‹±æ–‡ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m æœªçŸ¥æ•™è‚²éšæ®µæ‡‰è¿”å›å·²ç•¢æ¥­ï¼ˆå› ç‚ºç©ºé™£åˆ—ï¼‰[32m 0[2mms[22m[39m
       [32mâœ“[39m é»˜èªä½¿ç”¨è‹±æ–‡èªè¨€[32m 0[2mms[22m[39m
       [32mâœ“[39m é»˜èªä½¿ç”¨ç•¶å‰æ—¥æœŸ[32m 0[2mms[22m[39m
[90mstderr[2m | src/__tests__/unit/ai/gemini-retry.test.ts[2m > [22m[2mGeminiProvider Retry Logic[2m > [22m[2mshould retry on network error and eventually succeed
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/config.test.ts[2m > [22m[2mconfig module[2m > [22m[2mgetAppConfig[2m > [22m[2måº”è¯¥åœ¨é…ç½®æ–‡ä»¶è§£æå¤±è´¥æ—¶è¿”å›é»˜è®¤å€¼
[22m[39m[2m[11:26:57.382][0m [31mERROR[0m [34m(config)[0m: Failed to read config file
    [2merror:[0m [37mUnexpected token 'i', "invalid json{" is not valid JSON[0m

[90mstderr[2m | src/__tests__/unit/config.test.ts[2m > [22m[2mconfig module[2m > [22m[2mupdateAppConfig[2m > [22m[2måº”è¯¥åœ¨å†™å…¥å¤±è´¥æ—¶æŠ›å‡ºé”™è¯¯
[22m[39m[2m[11:26:57.387][0m [31mERROR[0m [34m(config)[0m: Failed to write config file
    [2merror:[0m [37mPermission denied[0m

 [32mâœ“[39m src/__tests__/unit/config.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 17[2mms[22m[39m
 [31mâ¯[39m src/__tests__/unit/ai/azure-provider.test.ts [2m([22m[2m30 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 16[2mms[22m[39m
       [32mâœ“[39m ç¼ºå°‘ API Key æ—¶åº”è¯¥æŠ›å‡º AI_AUTH_ERROR[32m 2[2mms[22m[39m
       [32mâœ“[39m API Key ä¸ºç©ºå­—ç¬¦ä¸²æ—¶åº”è¯¥æŠ›å‡º AI_AUTH_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m ç¼ºå°‘ endpoint æ—¶åº”è¯¥æŠ›å‡º AI_AUTH_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m endpoint ä¸ºç©ºå­—ç¬¦ä¸²æ—¶åº”è¯¥æŠ›å‡º AI_AUTH_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m ç¼ºå°‘ deploymentName æ—¶åº”è¯¥æŠ›å‡º AI_AUTH_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m deploymentName ä¸ºç©ºå­—ç¬¦ä¸²æ—¶åº”è¯¥æŠ›å‡º AI_AUTH_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m æœ‰æ•ˆé…ç½®æ—¶åº”è¯¥æˆåŠŸåˆ›å»ºå®ä¾‹[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥ä½¿ç”¨é»˜è®¤ API ç‰ˆæœ¬[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ”¯æŒè‡ªå®šä¹‰ API ç‰ˆæœ¬[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ”¯æŒè‡ªå®šä¹‰ model æ˜¾ç¤ºåç§°[32m 0[2mms[22m[39m
       [32mâœ“[39m analyzeImage æ–¹æ³•åº”è¯¥å­˜åœ¨å¹¶ä¸”æ˜¯å‡½æ•°[32m 0[2mms[22m[39m
       [32mâœ“[39m generateSimilarQuestion æ–¹æ³•åº”è¯¥å­˜åœ¨å¹¶ä¸”æ˜¯å‡½æ•°[32m 0[2mms[22m[39m
       [32mâœ“[39m reanswerQuestion æ–¹æ³•åº”è¯¥å­˜åœ¨å¹¶ä¸”æ˜¯å‡½æ•°[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m åº”è¯¥æ­£ç¡®è§£æåŒ…å«æ‰€æœ‰å¿…éœ€æ ‡ç­¾çš„å“åº”[39m[32m 7[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®å¤„ç† requiresImage ä¸º false[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®å¤„ç†æ— æ•ˆå­¦ç§‘è¿”å›é»˜è®¤å€¼"å…¶ä»–"[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®åˆ†å‰²çŸ¥è¯†ç‚¹(é€—å·åˆ†éš”)[32m 1[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®åˆ†å‰²çŸ¥è¯†ç‚¹(ä¸­æ–‡é€—å·åˆ†éš”)[32m 0[2mms[22m[39m
       [32mâœ“[39m ç¼ºå°‘å¿…éœ€æ ‡ç­¾æ—¶åº”è¯¥æŠ›å‡ºé”™è¯¯[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥æ­£ç¡®æå–æ ‡ç­¾å†…å®¹[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å»é™¤é¦–å°¾ç©ºæ ¼[32m 0[2mms[22m[39m
       [32mâœ“[39m æ ‡ç­¾ä¸å­˜åœ¨æ—¶åº”è¯¥è¿”å› null[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å¤„ç†å¤šè¡Œå†…å®¹[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å°†ç½‘ç»œé”™è¯¯è½¬æ¢ä¸º AI_CONNECTION_FAILED[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å°†è¿æ¥é”™è¯¯è½¬æ¢ä¸º AI_CONNECTION_FAILED[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å°†è®¤è¯é”™è¯¯è½¬æ¢ä¸º AI_AUTH_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å°† 401 é”™è¯¯è½¬æ¢ä¸º AI_AUTH_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m åº”è¯¥å°† JSON è§£æé”™è¯¯è½¬æ¢ä¸º AI_RESPONSE_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m æœªçŸ¥é”™è¯¯åº”è¯¥è½¬æ¢ä¸º AI_UNKNOWN_ERROR[32m 0[2mms[22m[39m
       [32mâœ“[39m é Error å¯¹è±¡åº”è¯¥è½¬æ¢ä¸º AI_UNKNOWN_ERROR[32m 0[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/auth-utils.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 3[2mms[22m[39m
[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸé‡æ–°å›ç­”é—®é¢˜
[22m[39m[2m[11:26:57.626][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸé‡æ–°å›ç­”é—®é¢˜
[22m[39m[2m[11:26:57.627][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m12[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

 [32mâœ“[39m src/__tests__/unit/utils.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 8[2mms[22m[39m
[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸé‡æ–°å›ç­”é—®é¢˜
[22m[39m[2m[11:26:57.627][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒæŒ‡å®šå­¦ç§‘
[22m[39m[2m[11:26:57.629][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒæŒ‡å®šå­¦ç§‘
[22m[39m[2m[11:26:57.630][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m54[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mè‹±è¯­[0m
    [2mhasImage:[0m [37mfalse[0m

 [32mâœ“[39m src/__tests__/unit/ai/providers.test.ts [2m([22m[2m11 tests[22m[2m)[22m[33m 358[2mms[22m[39m
[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒæŒ‡å®šå­¦ç§‘
[22m[39m[2m[11:26:57.630][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒé™„å¸¦å›¾ç‰‡
[22m[39m[2m[11:26:57.632][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒé™„å¸¦å›¾ç‰‡
[22m[39m[2m[11:26:57.632][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m10[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mæ•°å­¦[0m
    [2mhasImage:[0m [37mtrue[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒé™„å¸¦å›¾ç‰‡
[22m[39m[2m[11:26:57.632][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒè‹±æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.633][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒè‹±æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.633][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m16[0m
    [2mlanguage:[0m [37men[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ”¯æŒè‹±æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.633][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥é»˜è®¤ä½¿ç”¨ä¸­æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.634][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥é»˜è®¤ä½¿ç”¨ä¸­æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.634][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m4[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥é»˜è®¤ä½¿ç”¨ä¸­æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.634][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»ç©ºçš„é¢˜ç›®æ–‡æœ¬
[22m[39m[2m[11:26:57.635][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»ç©ºçš„é¢˜ç›®æ–‡æœ¬
[22m[39m[2m[11:26:57.635][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m0[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»ç©ºçš„é¢˜ç›®æ–‡æœ¬
[22m[39m[2m[11:26:57.635][0m [33mWARN [0m [34m(api:reanswer)[0m: Missing question text

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»åªæœ‰ç©ºæ ¼çš„é¢˜ç›®æ–‡æœ¬
[22m[39m[2m[11:26:57.636][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstderr[2m | src/__tests__/integration/settings.test.ts[2m > [22m[2m/api/settings[2m > [22m[2mPOST /api/settings[2m > [22m[2måº”è¯¥å¤„ç†æ›´æ–°å¤±è´¥çš„æƒ…å†µ
[22m[39m[2m[11:26:57.635][0m [31mERROR[0m [34m(api:settings)[0m: Failed to update settings
    [2merror:[0m [37mWrite failed[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»åªæœ‰ç©ºæ ¼çš„é¢˜ç›®æ–‡æœ¬
[22m[39m[2m[11:26:57.636][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m3[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»åªæœ‰ç©ºæ ¼çš„é¢˜ç›®æ–‡æœ¬
[22m[39m[2m[11:26:57.636][0m [33mWARN [0m [34m(api:reanswer)[0m: Missing question text

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»ç¼ºå°‘é¢˜ç›®æ–‡æœ¬çš„è¯·æ±‚
[22m[39m[2m[11:26:57.637][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»ç¼ºå°‘é¢˜ç›®æ–‡æœ¬çš„è¯·æ±‚
[22m[39m[2m[11:26:57.637][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

 [32mâœ“[39m src/__tests__/integration/settings.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 15[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mPOST /api/reanswer (é‡æ–°å›ç­”é—®é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»ç¼ºå°‘é¢˜ç›®æ–‡æœ¬çš„è¯·æ±‚
[22m[39m[2m[11:26:57.637][0m [33mWARN [0m [34m(api:reanswer)[0m: Missing question text

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI è®¤è¯é”™è¯¯
[22m[39m[2m[11:26:57.638][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI è®¤è¯é”™è¯¯
[22m[39m[2m[11:26:57.638][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m4[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI è®¤è¯é”™è¯¯
[22m[39m[2m[11:26:57.641][0m [31mERROR[0m [34m(api:reanswer)[0m: Reanswer error occurred
    [2merror:[0m [37mAI_AUTH_ERROR: Invalid API key[0m
    [2mstack:[0m [37mError: AI_AUTH_ERROR: Invalid API key
    at D:/MyApp/wrong-notebook/src/__tests__/integration/reanswer.test.ts:239:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI è¿æ¥é”™è¯¯
[22m[39m[2m[11:26:57.641][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI è¿æ¥é”™è¯¯
[22m[39m[2m[11:26:57.642][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m4[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ†æå›¾åƒ
[22m[39m[2m[11:26:57.641][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI è¿æ¥é”™è¯¯
[22m[39m[2m[11:26:57.642][0m [31mERROR[0m [34m(api:reanswer)[0m: Reanswer error occurred
    [2merror:[0m [37mAI_CONNECTION_FAILED[0m
    [2mstack:[0m [37mError: AI_CONNECTION_FAILED
    at D:/MyApp/wrong-notebook/src/__tests__/integration/reanswer.test.ts:260:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI å“åº”é”™è¯¯
[22m[39m[2m[11:26:57.643][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ†æå›¾åƒ
[22m[39m[2m[11:26:57.643][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m47[0m
    [2mmimeType:[0m [37mimage/png[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.643][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m25[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI å“åº”é”™è¯¯
[22m[39m[2m[11:26:57.643][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m4[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ†æå›¾åƒ
[22m[39m[2m[11:26:57.644][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.644][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç† AI å“åº”é”™è¯¯
[22m[39m[2m[11:26:57.643][0m [31mERROR[0m [34m(api:reanswer)[0m: Reanswer error occurred
    [2merror:[0m [37mAI_RESPONSE_ERROR[0m
    [2mstack:[0m [37mError: AI_RESPONSE_ERROR
    at D:/MyApp/wrong-notebook/src/__tests__/integration/reanswer.test.ts:281:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ†æå›¾åƒ
[22m[39m[2m[11:26:57.644][0m [36mDEBUG[0m [34m(api:analyze)[0m: AI returned knowledge points
    [2mknowledgePointsCount:[0m [37m2[0m
    [2mknowledgePointsType:[0m [37mobject[0m
    [2misArray:[0m [37mtrue[0m
[2m[11:26:57.644][0m [32mINFO [0m [34m(api:analyze)[0m: AI analysis successful

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç†å…¶ä»–æœªçŸ¥é”™è¯¯
[22m[39m[2m[11:26:57.644][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒ Data URL æ ¼å¼çš„å›¾åƒ
[22m[39m[2m[11:26:57.647][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç†å…¶ä»–æœªçŸ¥é”™è¯¯
[22m[39m[2m[11:26:57.644][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m4[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒ Data URL æ ¼å¼çš„å›¾åƒ
[22m[39m[2m[11:26:57.647][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m44[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.647][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/jpeg[0m
    [2mbase64Length:[0m [37m21[0m

[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç†å…¶ä»–æœªçŸ¥é”™è¯¯
[22m[39m[2m[11:26:57.644][0m [31mERROR[0m [34m(api:reanswer)[0m: Reanswer error occurred
    [2merror:[0m [37mUnknown error occurred[0m
    [2mstack:[0m [37mError: Unknown error occurred
    at D:/MyApp/wrong-notebook/src/__tests__/integration/reanswer.test.ts:302:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒ Data URL æ ¼å¼çš„å›¾åƒ
[22m[39m[2m[11:26:57.647][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.647][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç†æ²¡æœ‰é”™è¯¯æ¶ˆæ¯çš„å¼‚å¸¸
[22m[39m[2m[11:26:57.645][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstderr[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒ Data URL æ ¼å¼çš„å›¾åƒ
[22m[39m[2m[11:26:57.648][0m [33mWARN [0m [34m(api:analyze)[0m: Knowledge points is empty or null

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç†æ²¡æœ‰é”™è¯¯æ¶ˆæ¯çš„å¼‚å¸¸
[22m[39m[2m[11:26:57.645][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m4[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒ Data URL æ ¼å¼çš„å›¾åƒ
[22m[39m[2m[11:26:57.648][0m [36mDEBUG[0m [34m(api:analyze)[0m: AI returned knowledge points
    [2mknowledgePointsCount:[0m [37m0[0m
    [2mknowledgePointsType:[0m [37mobject[0m
    [2misArray:[0m [37mtrue[0m
[2m[11:26:57.648][0m [32mINFO [0m [34m(api:analyze)[0m: AI analysis successful

[90mstderr[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2mé”™è¯¯å¤„ç†[2m > [22m[2måº”è¯¥å¤„ç†æ²¡æœ‰é”™è¯¯æ¶ˆæ¯çš„å¼‚å¸¸
[22m[39m[2m[11:26:57.645][0m [31mERROR[0m [34m(api:reanswer)[0m: Reanswer error occurred
    [2merror:[0m [37m[0m
    [2mstack:[0m [37mError: 
    at D:/MyApp/wrong-notebook/src/__tests__/integration/reanswer.test.ts:322:68
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ‹’ç»ç¼ºå°‘å›¾åƒæ•°æ®çš„è¯·æ±‚
[22m[39m[2m[11:26:57.649][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†é•¿æ–‡æœ¬é¢˜ç›®
[22m[39m[2m[11:26:57.646][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ‹’ç»ç¼ºå°‘å›¾åƒæ•°æ®çš„è¯·æ±‚
[22m[39m[2m[11:26:57.649][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37mundefined[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†é•¿æ–‡æœ¬é¢˜ç›®
[22m[39m[2m[11:26:57.646][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m169[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mæ•°å­¦[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstderr[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ‹’ç»ç¼ºå°‘å›¾åƒæ•°æ®çš„è¯·æ±‚
[22m[39m[2m[11:26:57.649][0m [33mWARN [0m [34m(api:analyze)[0m: Missing image data

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†é•¿æ–‡æœ¬é¢˜ç›®
[22m[39m[2m[11:26:57.646][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å…³è”åˆ°æŒ‡å®šçš„ç§‘ç›®
[22m[39m[2m[11:26:57.650][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„é¢˜ç›®
[22m[39m[2m[11:26:57.646][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å…³è”åˆ°æŒ‡å®šçš„ç§‘ç›®
[22m[39m[2m[11:26:57.650][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37msubject-physics-id[0m
[2m[11:26:57.650][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„é¢˜ç›®
[22m[39m[2m[11:26:57.646][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m24[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mundefined[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å…³è”åˆ°æŒ‡å®šçš„ç§‘ç›®
[22m[39m[2m[11:26:57.650][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„é¢˜ç›®
[22m[39m[2m[11:26:57.646][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å…³è”åˆ°æŒ‡å®šçš„ç§‘ç›®
[22m[39m[2m[11:26:57.650][0m [36mDEBUG[0m [34m(api:analyze)[0m: Inferred subject
    [2msubjectName:[0m [37mmath[0m
    [2msubjectDisplayName:[0m [37mç‰©ç†[0m
[2m[11:26:57.650][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mæ•¸å­¸[0m

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†åŒ…å« LaTeX çš„é¢˜ç›®
[22m[39m[2m[11:26:57.647][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å…³è”åˆ°æŒ‡å®šçš„ç§‘ç›®
[22m[39m[2m[11:26:57.650][0m [36mDEBUG[0m [34m(api:analyze)[0m: AI returned knowledge points
    [2mknowledgePointsCount:[0m [37m1[0m
    [2mknowledgePointsType:[0m [37mobject[0m
    [2misArray:[0m [37mtrue[0m
[2m[11:26:57.650][0m [32mINFO [0m [34m(api:analyze)[0m: AI analysis successful

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†åŒ…å« LaTeX çš„é¢˜ç›®
[22m[39m[2m[11:26:57.647][0m [36mDEBUG[0m [34m(api:reanswer)[0m: Reanswer request received
    [2mquestionLength:[0m [37m22[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubject:[0m [37mæ•°å­¦[0m
    [2mhasImage:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒè‹±æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.651][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/reanswer.test.ts[2m > [22m[2m/api/reanswer[2m > [22m[2må¤æ‚åœºæ™¯[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†åŒ…å« LaTeX çš„é¢˜ç›®
[22m[39m[2m[11:26:57.647][0m [32mINFO [0m [34m(api:reanswer)[0m: Reanswer successful

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒè‹±æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.651][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37men[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.651][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒè‹±æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.651][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.651][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ”¯æŒè‹±æ–‡è¯­è¨€
[22m[39m[2m[11:26:57.651][0m [36mDEBUG[0m [34m(api:analyze)[0m: AI returned knowledge points
    [2mknowledgePointsCount:[0m [37m1[0m
    [2mknowledgePointsType:[0m [37mobject[0m
    [2misArray:[0m [37mtrue[0m
[2m[11:26:57.651][0m [32mINFO [0m [34m(api:analyze)[0m: AI analysis successful

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è®¤è¯é”™è¯¯
[22m[39m[2m[11:26:57.652][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è®¤è¯é”™è¯¯
[22m[39m[2m[11:26:57.652][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.652][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è®¤è¯é”™è¯¯
[22m[39m[2m[11:26:57.652][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.652][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

 [32mâœ“[39m src/__tests__/integration/reanswer.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 25[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è®¤è¯é”™è¯¯
[22m[39m[2m[11:26:57.654][0m [31mERROR[0m [34m(api:analyze)[0m: Analysis error occurred
    [2merror:[0m [37mAI_AUTH_ERROR: Invalid API key[0m
    [2mstack:[0m [37mError: AI_AUTH_ERROR: Invalid API key
    at D:/MyApp/wrong-notebook/src/__tests__/integration/analyze.test.ts:200:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è¿æ¥é”™è¯¯
[22m[39m[2m[11:26:57.655][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è¿æ¥é”™è¯¯
[22m[39m[2m[11:26:57.655][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.655][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è¿æ¥é”™è¯¯
[22m[39m[2m[11:26:57.655][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.655][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstderr[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI è¿æ¥é”™è¯¯
[22m[39m[2m[11:26:57.656][0m [31mERROR[0m [34m(api:analyze)[0m: Analysis error occurred
    [2merror:[0m [37mAI_CONNECTION_FAILED[0m
    [2mstack:[0m [37mError: AI_CONNECTION_FAILED
    at D:/MyApp/wrong-notebook/src/__tests__/integration/analyze.test.ts:221:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI å“åº”é”™è¯¯
[22m[39m[2m[11:26:57.656][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI å“åº”é”™è¯¯
[22m[39m[2m[11:26:57.656][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.656][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI å“åº”é”™è¯¯
[22m[39m[2m[11:26:57.657][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.657][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstderr[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† AI å“åº”é”™è¯¯
[22m[39m[2m[11:26:57.657][0m [31mERROR[0m [34m(api:analyze)[0m: Analysis error occurred
    [2merror:[0m [37mAI_RESPONSE_ERROR[0m
    [2mstack:[0m [37mError: AI_RESPONSE_ERROR
    at D:/MyApp/wrong-notebook/src/__tests__/integration/analyze.test.ts:242:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† Zod éªŒè¯é”™è¯¯
[22m[39m[2m[11:26:57.657][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

 [32mâœ“[39m src/__tests__/integration/notebooks.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 16[2mms[22m[39m
[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† Zod éªŒè¯é”™è¯¯
[22m[39m[2m[11:26:57.658][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.658][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† Zod éªŒè¯é”™è¯¯
[22m[39m[2m[11:26:57.658][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.658][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstderr[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç† Zod éªŒè¯é”™è¯¯
[22m[39m[2m[11:26:57.658][0m [31mERROR[0m [34m(api:analyze)[0m: Analysis error occurred
    [2merror:[0m [37mZod validation failed[0m
    [2mstack:[0m [37mError: Zod validation failed
    at D:/MyApp/wrong-notebook/src/__tests__/integration/analyze.test.ts:263:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç†æœªçŸ¥é”™è¯¯
[22m[39m[2m[11:26:57.658][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç†æœªçŸ¥é”™è¯¯
[22m[39m[2m[11:26:57.659][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.659][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç†æœªçŸ¥é”™è¯¯
[22m[39m[2m[11:26:57.659][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.659][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstderr[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥å¤„ç†æœªçŸ¥é”™è¯¯
[22m[39m[2m[11:26:57.659][0m [31mERROR[0m [34m(api:analyze)[0m: Analysis error occurred
    [2merror:[0m [37mUnknown error[0m
    [2mstack:[0m [37mError: Unknown error
    at D:/MyApp/wrong-notebook/src/__tests__/integration/analyze.test.ts:284:17
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1206:10)
    at file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:37
    at Traces.$ (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///D:/MyApp/wrong-notebook/node_modules/vitest/dist/chunks/test.BT8LKgU9.js:239:21)
    at runTest (file:///D:/MyApp/wrong-notebook/node_modules/@vitest/runner/dist/index.js:1650:12)[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ ‡å‡†åŒ–çŸ¥è¯†ç‚¹æ ‡ç­¾
[22m[39m[2m[11:26:57.659][0m [32mINFO [0m [34m(api:analyze)[0m: Analyze API called

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ ‡å‡†åŒ–çŸ¥è¯†ç‚¹æ ‡ç­¾
[22m[39m[2m[11:26:57.659][0m [36mDEBUG[0m [34m(api:analyze)[0m: Request received
    [2mimageLength:[0m [37m29[0m
    [2mmimeType:[0m [37mundefined[0m
    [2mlanguage:[0m [37mzh[0m
    [2msubjectId:[0m [37mundefined[0m
[2m[11:26:57.659][0m [36mDEBUG[0m [34m(api:analyze)[0m: Parsed Data URL
    [2mmimeType:[0m [37mimage/png[0m
    [2mbase64Length:[0m [37m7[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ ‡å‡†åŒ–çŸ¥è¯†ç‚¹æ ‡ç­¾
[22m[39m[2m[11:26:57.659][0m [36mDEBUG[0m [34m(api:analyze)[0m: Calculated user grade
    [2muserGrade:[0m [37m7[0m
[2m[11:26:57.660][0m [32mINFO [0m [34m(api:analyze)[0m: Calling AI service for image analysis
    [2muserGrade:[0m [37m7[0m
    [2msubject:[0m [37mnull[0m

[90mstdout[2m | src/__tests__/integration/analyze.test.ts[2m > [22m[2m/api/analyze[2m > [22m[2mPOST /api/analyze (å›¾åƒåˆ†æ)[2m > [22m[2måº”è¯¥æ ‡å‡†åŒ–çŸ¥è¯†ç‚¹æ ‡ç­¾
[22m[39m[2m[11:26:57.660][0m [36mDEBUG[0m [34m(api:analyze)[0m: AI returned knowledge points
    [2mknowledgePointsCount:[0m [37m2[0m
    [2mknowledgePointsType:[0m [37mobject[0m
    [2misArray:[0m [37mtrue[0m
[2m[11:26:57.660][0m [32mINFO [0m [34m(api:analyze)[0m: AI analysis successful

 [32mâœ“[39m src/__tests__/integration/analyze.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 22[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/practice.test.ts[2m > [22m[2m/api/practice[2m > [22m[2mPOST /api/practice/generate (ç”Ÿæˆç±»ä¼¼é¢˜ç›®)[2m > [22m[2måº”è¯¥å¤„ç† AI æœåŠ¡é”™è¯¯
[22m[39m[2m[11:26:57.714][0m [31mERROR[0m [34m(api:practice:generate)[0m: Error generating practice
    [2merror:[0m [37mAI service unavailable[0m

[90mstderr[2m | src/__tests__/integration/practice.test.ts[2m > [22m[2m/api/practice[2m > [22m[2mPOST /api/practice/record (è®°å½•ç»ƒä¹ ç»“æœ)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:57.717][0m [31mERROR[0m [34m(api:practice:record)[0m: Error saving practice record
    [2merror:[0m [37mDatabase connection failed[0m

 [32mâœ“[39m src/__tests__/integration/practice.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 18[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/api-errors.test.ts [2m([22m[2m30 tests[22m[2m)[22m[32m 17[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/tags.test.ts[2m > [22m[2m/api/tags[2m > [22m[2mGET /api/tags/stats (æ ‡ç­¾ç»Ÿè®¡)[2m > [22m[2måº”è¯¥å¤„ç†æ— æ•ˆçš„ JSON çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.736][0m [33mWARN [0m [34m(api:tags:stats)[0m: Failed to parse knowledgePoints for item
    [2mknowledgePoints:[0m [37minvalid json{[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.737][0m [32mINFO [0m [34m(api:error-items)[0m: POST /api/error-items called

 [32mâœ“[39m src/__tests__/unit/middleware.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 15[2mms[22m[39m
[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.739][0m [36mDEBUG[0m [34m(api:error-items)[0m: Request parameters received
    [2mhasQuestionText:[0m [37mtrue[0m
    [2mquestionTextLength:[0m [37m12[0m
    [2mhasAnswerText:[0m [37mtrue[0m
    [2mhasAnalysis:[0m [37mtrue[0m
    [2mknowledgePointsCount:[0m [37m2[0m
    [2mhasImage:[0m [37mtrue[0m
    [2mimageSize:[0m [37m29[0m
    [2msubjectId:[0m [37mundefined[0m
    [2mgradeSemester:[0m [37mundefined[0m
    [2mpaperLevel:[0m [37mundefined[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.739][0m [36mDEBUG[0m [34m(api:error-items)[0m: User lookup result
    [2muserId:[0m [37muser-123[0m
    [2memail:[0m [37muser@example.com[0m

[90mstderr[2m | src/__tests__/integration/tags.test.ts[2m > [22m[2m/api/tags[2m > [22m[2mGET /api/tags/stats (æ ‡ç­¾ç»Ÿè®¡)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:57.739][0m [31mERROR[0m [34m(api:tags:stats)[0m: Error getting tag stats
    [2merror:[0m [37mDatabase connection failed[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.739][0m [36mDEBUG[0m [34m(api:error-items)[0m: Grade calculated
    [2mfinalGradeSemester:[0m [37måˆä¸€ï¼Œä¸ŠæœŸ[0m
    [2meducationStage:[0m [37mjunior_high[0m
    [2menrollmentYear:[0m [37m2024[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.739][0m [36mDEBUG[0m [34m(api:error-items)[0m: Subject inferred
    [2msubjectId:[0m [37mundefined[0m
    [2msubjectName:[0m [37mundefined[0m
    [2msubjectKey:[0m [37mother[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.739][0m [36mDEBUG[0m [34m(api:error-items)[0m: Existing tag found
    [2mtagId:[0m [37mtag-ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹[0m
    [2mtagName:[0m [37mä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹[0m
    [2misSystem:[0m [37mfalse[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.739][0m [36mDEBUG[0m [34m(api:error-items)[0m: Existing tag found
    [2mtagId:[0m [37mtag-ç§»é¡¹[0m
    [2mtagName:[0m [37mç§»é¡¹[0m
    [2misSystem:[0m [37mfalse[0m
[2m[11:26:57.739][0m [32mINFO [0m [34m(api:error-items)[0m: Creating ErrorItem with tags
    [2mtagNames:[0m [37m[
  "ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹",
  "ç§»é¡¹"
][0m
    [2mtagConnectionsCount:[0m [37m2[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.739][0m [32mINFO [0m [34m(api:error-items)[0m: ErrorItem created successfully
    [2merrorItemId:[0m [37merror-item-1[0m
    [2mtagsCount:[0m [37m0[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶å…³è”åˆ°ç§‘ç›®
[22m[39m[2m[11:26:57.741][0m [32mINFO [0m [34m(api:error-items)[0m: POST /api/error-items called

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶å…³è”åˆ°ç§‘ç›®
[22m[39m[2m[11:26:57.741][0m [36mDEBUG[0m [34m(api:error-items)[0m: Request parameters received
    [2mhasQuestionText:[0m [37mtrue[0m
    [2mquestionTextLength:[0m [37m8[0m
    [2mhasAnswerText:[0m [37mtrue[0m
    [2mhasAnalysis:[0m [37mtrue[0m
    [2mknowledgePointsCount:[0m [37m1[0m
    [2mhasImage:[0m [37mtrue[0m
    [2mimageSize:[0m [37m29[0m
    [2msubjectId:[0m [37msubject-math-id[0m
    [2mgradeSemester:[0m [37mundefined[0m
    [2mpaperLevel:[0m [37mundefined[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶å…³è”åˆ°ç§‘ç›®
[22m[39m[2m[11:26:57.741][0m [36mDEBUG[0m [34m(api:error-items)[0m: User lookup result
    [2muserId:[0m [37muser-123[0m
    [2memail:[0m [37muser@example.com[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶å…³è”åˆ°ç§‘ç›®
[22m[39m[2m[11:26:57.741][0m [36mDEBUG[0m [34m(api:error-items)[0m: Grade calculated
    [2mfinalGradeSemester:[0m [37måˆä¸€ï¼Œä¸ŠæœŸ[0m
    [2meducationStage:[0m [37mjunior_high[0m
    [2menrollmentYear:[0m [37m2024[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶å…³è”åˆ°ç§‘ç›®
[22m[39m[2m[11:26:57.742][0m [36mDEBUG[0m [34m(api:error-items)[0m: Subject inferred
    [2msubjectId:[0m [37msubject-math-id[0m
    [2msubjectName:[0m [37mundefined[0m
    [2msubjectKey:[0m [37mother[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶å…³è”åˆ°ç§‘ç›®
[22m[39m[2m[11:26:57.742][0m [36mDEBUG[0m [34m(api:error-items)[0m: Existing tag found
    [2mtagId:[0m [37mtag-åŠ æ³•[0m
    [2mtagName:[0m [37måŠ æ³•[0m
    [2misSystem:[0m [37mfalse[0m
[2m[11:26:57.742][0m [32mINFO [0m [34m(api:error-items)[0m: Creating ErrorItem with tags
    [2mtagNames:[0m [37m[
  "åŠ æ³•"
][0m
    [2mtagConnectionsCount:[0m [37m1[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶å…³è”åˆ°ç§‘ç›®
[22m[39m[2m[11:26:57.742][0m [32mINFO [0m [34m(api:error-items)[0m: ErrorItem created successfully
    [2merrorItemId:[0m [37merror-item-2[0m
    [2mtagsCount:[0m [37m0[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶è®¾ç½®å¹´çº§å­¦æœŸ
[22m[39m[2m[11:26:57.742][0m [32mINFO [0m [34m(api:error-items)[0m: POST /api/error-items called

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶è®¾ç½®å¹´çº§å­¦æœŸ
[22m[39m[2m[11:26:57.742][0m [36mDEBUG[0m [34m(api:error-items)[0m: Request parameters received
    [2mhasQuestionText:[0m [37mtrue[0m
    [2mquestionTextLength:[0m [37m4[0m
    [2mhasAnswerText:[0m [37mtrue[0m
    [2mhasAnalysis:[0m [37mtrue[0m
    [2mknowledgePointsCount:[0m [37m1[0m
    [2mhasImage:[0m [37mtrue[0m
    [2mimageSize:[0m [37m29[0m
    [2msubjectId:[0m [37mundefined[0m
    [2mgradeSemester:[0m [37måˆä¸€ä¸ŠæœŸ[0m
    [2mpaperLevel:[0m [37mA[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶è®¾ç½®å¹´çº§å­¦æœŸ
[22m[39m[2m[11:26:57.742][0m [36mDEBUG[0m [34m(api:error-items)[0m: User lookup result
    [2muserId:[0m [37muser-123[0m
    [2memail:[0m [37muser@example.com[0m

[90mstderr[2m | src/__tests__/integration/tags.test.ts[2m > [22m[2m/api/tags[2m > [22m[2mGET /api/tags/suggestions (æ ‡ç­¾å»ºè®®)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:57.742][0m [31mERROR[0m [34m(api:tags:suggestions)[0m: Error getting tag suggestions
    [2merror:[0m [37mDatabase connection failed[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶è®¾ç½®å¹´çº§å­¦æœŸ
[22m[39m[2m[11:26:57.743][0m [36mDEBUG[0m [34m(api:error-items)[0m: Subject inferred
    [2msubjectId:[0m [37mundefined[0m
    [2msubjectName:[0m [37mundefined[0m
    [2msubjectKey:[0m [37mother[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶è®¾ç½®å¹´çº§å­¦æœŸ
[22m[39m[2m[11:26:57.743][0m [36mDEBUG[0m [34m(api:error-items)[0m: Existing tag found
    [2mtagId:[0m [37mtag-æ–¹ç¨‹[0m
    [2mtagName:[0m [37mæ–¹ç¨‹[0m
    [2misSystem:[0m [37mfalse[0m
[2m[11:26:57.743][0m [32mINFO [0m [34m(api:error-items)[0m: Creating ErrorItem with tags
    [2mtagNames:[0m [37m[
  "æ–¹ç¨‹"
][0m
    [2mtagConnectionsCount:[0m [37m1[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸåˆ›å»ºé”™é¢˜å¹¶è®¾ç½®å¹´çº§å­¦æœŸ
[22m[39m[2m[11:26:57.743][0m [32mINFO [0m [34m(api:error-items)[0m: ErrorItem created successfully
    [2merrorItemId:[0m [37merror-item-3[0m
    [2mtagsCount:[0m [37m0[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»æœªç™»å½•ç”¨æˆ·åˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.743][0m [32mINFO [0m [34m(api:error-items)[0m: POST /api/error-items called

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»æœªç™»å½•ç”¨æˆ·åˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.743][0m [36mDEBUG[0m [34m(api:error-items)[0m: Request parameters received
    [2mhasQuestionText:[0m [37mtrue[0m
    [2mquestionTextLength:[0m [37m4[0m
    [2mhasAnswerText:[0m [37mfalse[0m
    [2mhasAnalysis:[0m [37mfalse[0m
    [2mknowledgePointsCount:[0m [37m0[0m
    [2mhasImage:[0m [37mtrue[0m
    [2mimageSize:[0m [37m4[0m
    [2msubjectId:[0m [37mundefined[0m
    [2mgradeSemester:[0m [37mundefined[0m
    [2mpaperLevel:[0m [37mundefined[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»æœªç™»å½•ç”¨æˆ·åˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.743][0m [36mDEBUG[0m [34m(api:error-items)[0m: User lookup result
    [2muserId:[0m [37mundefined[0m
    [2memail:[0m [37muser@example.com[0m

 [32mâœ“[39m src/__tests__/integration/tags.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 16[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»æœªç™»å½•ç”¨æˆ·åˆ›å»ºé”™é¢˜
[22m[39m[2m[11:26:57.743][0m [33mWARN [0m [34m(api:error-items)[0m: User not found in DB
    [2msessionEmail:[0m [37muser@example.com[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥è‡ªåŠ¨è®¡ç®—å¹´çº§å­¦æœŸï¼ˆå¦‚æœæœªæä¾›ï¼‰
[22m[39m[2m[11:26:57.744][0m [32mINFO [0m [34m(api:error-items)[0m: POST /api/error-items called

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥è‡ªåŠ¨è®¡ç®—å¹´çº§å­¦æœŸï¼ˆå¦‚æœæœªæä¾›ï¼‰
[22m[39m[2m[11:26:57.744][0m [36mDEBUG[0m [34m(api:error-items)[0m: Request parameters received
    [2mhasQuestionText:[0m [37mtrue[0m
    [2mquestionTextLength:[0m [37m2[0m
    [2mhasAnswerText:[0m [37mtrue[0m
    [2mhasAnalysis:[0m [37mtrue[0m
    [2mknowledgePointsCount:[0m [37m1[0m
    [2mhasImage:[0m [37mtrue[0m
    [2mimageSize:[0m [37m29[0m
    [2msubjectId:[0m [37mundefined[0m
    [2mgradeSemester:[0m [37mundefined[0m
    [2mpaperLevel:[0m [37mundefined[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥è‡ªåŠ¨è®¡ç®—å¹´çº§å­¦æœŸï¼ˆå¦‚æœæœªæä¾›ï¼‰
[22m[39m[2m[11:26:57.744][0m [36mDEBUG[0m [34m(api:error-items)[0m: User lookup result
    [2muserId:[0m [37muser-123[0m
    [2memail:[0m [37muser@example.com[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥è‡ªåŠ¨è®¡ç®—å¹´çº§å­¦æœŸï¼ˆå¦‚æœæœªæä¾›ï¼‰
[22m[39m[2m[11:26:57.744][0m [36mDEBUG[0m [34m(api:error-items)[0m: Grade calculated
    [2mfinalGradeSemester:[0m [37måˆä¸€ï¼Œä¸ŠæœŸ[0m
    [2meducationStage:[0m [37mjunior_high[0m
    [2menrollmentYear:[0m [37m2024[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥è‡ªåŠ¨è®¡ç®—å¹´çº§å­¦æœŸï¼ˆå¦‚æœæœªæä¾›ï¼‰
[22m[39m[2m[11:26:57.744][0m [36mDEBUG[0m [34m(api:error-items)[0m: Subject inferred
    [2msubjectId:[0m [37mundefined[0m
    [2msubjectName:[0m [37mundefined[0m
    [2msubjectKey:[0m [37mother[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥è‡ªåŠ¨è®¡ç®—å¹´çº§å­¦æœŸï¼ˆå¦‚æœæœªæä¾›ï¼‰
[22m[39m[2m[11:26:57.744][0m [36mDEBUG[0m [34m(api:error-items)[0m: Existing tag found
    [2mtagId:[0m [37mtag-çŸ¥è¯†ç‚¹[0m
    [2mtagName:[0m [37mçŸ¥è¯†ç‚¹[0m
    [2misSystem:[0m [37mfalse[0m
[2m[11:26:57.744][0m [32mINFO [0m [34m(api:error-items)[0m: Creating ErrorItem with tags
    [2mtagNames:[0m [37m[
  "çŸ¥è¯†ç‚¹"
][0m
    [2mtagConnectionsCount:[0m [37m1[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥è‡ªåŠ¨è®¡ç®—å¹´çº§å­¦æœŸï¼ˆå¦‚æœæœªæä¾›ï¼‰
[22m[39m[2m[11:26:57.744][0m [32mINFO [0m [34m(api:error-items)[0m: ErrorItem created successfully
    [2merrorItemId:[0m [37merror-item-4[0m
    [2mtagsCount:[0m [37m0[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†å­—ç¬¦ä¸²æ ¼å¼çš„çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.745][0m [32mINFO [0m [34m(api:error-items)[0m: POST /api/error-items called

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†å­—ç¬¦ä¸²æ ¼å¼çš„çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.745][0m [36mDEBUG[0m [34m(api:error-items)[0m: Request parameters received
    [2mhasQuestionText:[0m [37mtrue[0m
    [2mquestionTextLength:[0m [37m2[0m
    [2mhasAnswerText:[0m [37mtrue[0m
    [2mhasAnalysis:[0m [37mtrue[0m
    [2mknowledgePointsCount:[0m [37m0[0m
    [2mhasImage:[0m [37mtrue[0m
    [2mimageSize:[0m [37m29[0m
    [2msubjectId:[0m [37mundefined[0m
    [2mgradeSemester:[0m [37mundefined[0m
    [2mpaperLevel:[0m [37mundefined[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†å­—ç¬¦ä¸²æ ¼å¼çš„çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.745][0m [36mDEBUG[0m [34m(api:error-items)[0m: User lookup result
    [2muserId:[0m [37muser-123[0m
    [2memail:[0m [37muser@example.com[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†å­—ç¬¦ä¸²æ ¼å¼çš„çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.745][0m [36mDEBUG[0m [34m(api:error-items)[0m: Grade calculated
    [2mfinalGradeSemester:[0m [37måˆä¸€ï¼Œä¸ŠæœŸ[0m
    [2meducationStage:[0m [37mjunior_high[0m
    [2menrollmentYear:[0m [37m2024[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†å­—ç¬¦ä¸²æ ¼å¼çš„çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.745][0m [36mDEBUG[0m [34m(api:error-items)[0m: Subject inferred
    [2msubjectId:[0m [37mundefined[0m
    [2msubjectName:[0m [37mundefined[0m
    [2msubjectKey:[0m [37mother[0m
[2m[11:26:57.745][0m [32mINFO [0m [34m(api:error-items)[0m: Creating ErrorItem with tags
    [2mtagNames:[0m [37m[][0m
    [2mtagConnectionsCount:[0m [37m0[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPOST /api/error-items (åˆ›å»ºé”™é¢˜)[2m > [22m[2måº”è¯¥æ­£ç¡®å¤„ç†å­—ç¬¦ä¸²æ ¼å¼çš„çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.745][0m [32mINFO [0m [34m(api:error-items)[0m: ErrorItem created successfully
    [2merrorItemId:[0m [37merror-item-5[0m
    [2mtagsCount:[0m [37m0[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPUT /api/error-items/[id] (æ›´æ–°é”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸæ›´æ–°çŸ¥è¯†ç‚¹
[22m[39m[2m[11:26:57.747][0m [32mINFO [0m [34m(api:error-items:id)[0m: Updating error item
    [2mid:[0m [37merror-item-1[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPUT /api/error-items/[id] (æ›´æ–°é”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸæ›´æ–°å¹´çº§å­¦æœŸ
[22m[39m[2m[11:26:57.747][0m [32mINFO [0m [34m(api:error-items:id)[0m: Updating error item
    [2mid:[0m [37merror-item-1[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPUT /api/error-items/[id] (æ›´æ–°é”™é¢˜)[2m > [22m[2måº”è¯¥æˆåŠŸæ›´æ–°è¯•å·ç­‰çº§
[22m[39m[2m[11:26:57.748][0m [32mINFO [0m [34m(api:error-items:id)[0m: Updating error item
    [2mid:[0m [37merror-item-1[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPATCH /api/error-items/[id]/notes (æ›´æ–°ç¬”è®°)[2m > [22m[2måº”è¯¥æ‹’ç»æœªç™»å½•ç”¨æˆ·
[22m[39m[2m[11:26:57.753][0m [36mDEBUG[0m [34m(api:error-items:notes)[0m: No session or user found, attempting fallback to first user

[90mstderr[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPATCH /api/error-items/[id]/notes (æ›´æ–°ç¬”è®°)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:57.754][0m [31mERROR[0m [34m(api:error-items:notes)[0m: Error updating notes
    [2merror:[0m [37mDatabase error[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPATCH /api/error-items/[id]/mastery (æ›´æ–°æŒæ¡ç¨‹åº¦)[2m > [22m[2måº”è¯¥æ‹’ç»æœªç™»å½•ç”¨æˆ·
[22m[39m[2m[11:26:57.755][0m [36mDEBUG[0m [34m(api:error-items:mastery)[0m: No session or user found, attempting fallback to first user

 [32mâœ“[39m src/__tests__/integration/admin-users.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 8[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mPATCH /api/error-items/[id]/mastery (æ›´æ–°æŒæ¡ç¨‹åº¦)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:57.755][0m [31mERROR[0m [34m(api:error-items:mastery)[0m: Error updating item
    [2merror:[0m [37mDatabase error[0m

[90mstdout[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mDELETE /api/error-items/[id]/delete (åˆ é™¤é”™é¢˜)[2m > [22m[2måº”è¯¥æ‹’ç»æœªç™»å½•ç”¨æˆ·
[22m[39m[2m[11:26:57.757][0m [36mDEBUG[0m [34m(api:error-items:delete)[0m: No session or user found, attempting fallback to first user

[90mstderr[2m | src/__tests__/integration/error-items.test.ts[2m > [22m[2m/api/error-items[2m > [22m[2mDELETE /api/error-items/[id]/delete (åˆ é™¤é”™é¢˜)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:57.757][0m [31mERROR[0m [34m(api:error-items:delete)[0m: Error deleting item
    [2merror:[0m [37mDatabase error[0m

 [32mâœ“[39m src/__tests__/integration/error-items.test.ts [2m([22m[2m36 tests[22m[2m)[22m[32m 24[2mms[22m[39m
[90mstdout[2m | src/__tests__/integration/user.test.ts[2m > [22m[2m/api/user[2m > [22m[2mGET /api/user[2m > [22m[2måº”è¯¥è¿”å›ç”¨æˆ·ä¿¡æ¯
[22m[39m[2m[11:26:57.776][0m [36mDEBUG[0m [34m(api:user)[0m: Returning user profile
    [2muser:[0m [37m{
  "name": "Test User",
  "email": "test@example.com",
  "educationStage": "junior_high",
  "enrollmentYear": 2024
}[0m

 [32mâœ“[39m src/__tests__/integration/user.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/__tests__/integration/register.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 9[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/stats.test.ts[2m > [22m[2m/api/stats[2m > [22m[2mGET /api/stats/practice (è·å–ç»ƒä¹ ç»Ÿè®¡)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:58.319][0m [31mERROR[0m [34m(api:stats:practice)[0m: Error fetching practice stats
    [2merror:[0m [37mDatabase connection failed[0m

[90mstderr[2m | src/__tests__/integration/stats.test.ts[2m > [22m[2m/api/stats[2m > [22m[2mDELETE /api/stats/practice/clear (æ¸…é™¤ç»ƒä¹ è®°å½•)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:58.321][0m [31mERROR[0m [34m(api:stats:practice:clear)[0m: Error clearing practice stats
    [2merror:[0m [37mDatabase error[0m

[90mstderr[2m | src/__tests__/integration/stats.test.ts[2m > [22m[2m/api/stats[2m > [22m[2mDELETE /api/error-items/clear (æ¸…é™¤æ‰€æœ‰é”™é¢˜)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:58.323][0m [31mERROR[0m [34m(api:error-items:clear)[0m: Error clearing error data
    [2merror:[0m [37mDatabase error[0m

 [32mâœ“[39m src/__tests__/integration/stats.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 16[2mms[22m[39m
[90mstderr[2m | src/__tests__/integration/analytics.test.ts[2m > [22m[2m/api/analytics[2m > [22m[2mGET /api/analytics (è·å–åˆ†æç»Ÿè®¡)[2m > [22m[2måº”è¯¥å¤„ç†æ•°æ®åº“é”™è¯¯
[22m[39m[2m[11:26:58.381][0m [31mERROR[0m [34m(api:analytics)[0m: Error fetching analytics
    [2merror:[0m [37mDatabase connection failed[0m

 [32mâœ“[39m src/__tests__/integration/analytics.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 9[2mms[22m[39m
[90mstderr[2m | src/__tests__/unit/ai/gemini-retry.test.ts[2m > [22m[2mGeminiProvider Retry Logic[2m > [22m[2mshould throw immediately on non-retryable error
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai/gemini-retry.test.ts[2m > [22m[2mGeminiProvider Retry Logic[2m > [22m[2mshould give up after max retries
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai/gemini-retry.test.ts[2m > [22m[2mGeminiProvider Retry Logic[2m > [22m[2mshould retry on 503 service unavailable
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

[90mstderr[2m | src/__tests__/unit/ai/gemini-retry.test.ts[2m > [22m[2mGeminiProvider Retry Logic[2m > [22m[2mshould retry on connection reset
[22m[39m[prompts] No prefetched tags provided, AI will tag freely

 [32mâœ“[39m src/__tests__/unit/ai/gemini-retry.test.ts [2m([22m[2m5 tests[22m[2m)[22m[33m 12361[2mms[22m[39m
     [33m[2mâœ“[22m[39m should retry on network error and eventually succeed [33m 4624[2mms[22m[39m
     [33m[2mâœ“[22m[39m should give up after max retries [33m 4639[2mms[22m[39m
     [33m[2mâœ“[22m[39m should retry on 503 service unavailable [33m 1548[2mms[22m[39m
     [33m[2mâœ“[22m[39m should retry on connection reset [33m 1547[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 12 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/ai-prompts.test.ts[2m > [22mAI Prompts[2m > [22mgenerateAnalyzePrompt[2m > [22måº”è¯¥åŒ…å«å­¦ç§‘æç¤ºï¼ˆå¦‚æœæä¾›ï¼‰
[31m[1mAssertionError[22m: expected 'ã€è§’è‰²èˆ‡æ ¸å¿ƒä»»å‹™ (ROLE AND CORE TASK)ã€‘\nä½ æ˜¯ä¸€ä½ä¸–â€¦' to contain 'æ•°å­¦'[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- æ•°å­¦[39m
[31m+ ã€è§’è‰²èˆ‡æ ¸å¿ƒä»»å‹™ (ROLE AND CORE TASK)ã€‘[39m
[31m+ ä½ æ˜¯ä¸€ä½ä¸–ç•Œé ‚å°–çš„ã€ç¶“é©—è±å¯Œçš„ã€å°ˆæ¥­çš„è·¨å­¸ç§‘è€ƒè©¦åˆ†æå°ˆå®¶ï¼ˆInterdisciplinary Exam Analysis Expertï¼‰ã€‚ä½ çš„æ ¸å¿ƒä»»å‹™æ˜¯æ¥µè‡´æº–ç¢ºåœ°åˆ†æç”¨æˆ¶æä¾›çš„è€ƒè©¦é¡Œç›®åœ–ç‰‡ï¼Œå…¨é¢ç†è§£æ‰€æœ‰æ–‡æœ¬ã€åœ–è¡¨å’Œéš±å«ç´„æŸï¼Œä¸¦æä¾›ä¸€å€‹å®Œæ•´ã€é«˜åº¦çµæ§‹åŒ–ä¸”å°ˆæ¥­çš„è§£æ±ºæ–¹æ¡ˆã€‚[39m
[31m+[39m
[31m+ IMPORTANT: For the 'analysis' field, use Traditional Chinese (Taiwan). For 'questionText' and 'answerText', YOU MUST USE THE SAME LANGUAGE AS THE ORIGINAL QUESTION. If the original question is in Chinese, the new question MUST be in Traditional Chinese. If the original is in English, keep it in English. If the original question is in English, the new 'questionText' and 'answerText' MUST be in English, but the 'analysis' MUST be in Traditional Chinese (to help the student understand). [39m
[31m+[39m
[31m+ ã€æ ¸å¿ƒè¼¸å‡ºè¦æ±‚ (OUTPUT REQUIREMENTS)ã€‘[39m
[31m+ ä½ çš„éŸ¿æ‡‰è¼¸å‡º**å¿…é ˆåš´æ ¼éµå¾ªä»¥ä¸‹è‡ªå®šç¾©æ¨™ç±¤æ ¼å¼**ã€‚**åš´ç¦**ä½¿ç”¨ JSON æˆ– Markdown ä»£ç¢¼å¡Šã€‚**åš´ç¦**å° LaTeX å…¬å¼ä¸­çš„åæ–œç·šé€²è¡ŒäºŒæ¬¡è·³è„«ï¼ˆå¦‚ "\frac" æ˜¯éŒ¯èª¤çš„ï¼Œå¿…é ˆæ˜¯ "rac"ï¼‰ã€‚[39m
[31m+[39m
[31m+ è«‹åš´æ ¼æŒ‰ç…§ä»¥ä¸‹çµæ§‹è¼¸å‡ºå…§å®¹ï¼š[39m
[31m+[39m
[31m+ <subject>[39m
[31m+ åœ¨æ­¤è™•å¡«å¯«å­¸ç§‘ï¼Œå¿…é ˆæ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š"æ•¸å­¸", "ç‰©ç†", "åŒ–å­¸", "ç”Ÿç‰©", "è‹±èª", "åœ‹æ–‡", "æ­·å²", "åœ°ç†", "å…¬æ°‘", "å…¶ä»–"ã€‚[39m
[31m+ </subject>[39m
[31m+[39m
[31m+ <knowledge_points>[39m
[31m+ åœ¨æ­¤è™•å¡«å¯«çŸ¥è­˜é»ï¼Œä½¿ç”¨é€—è™Ÿåˆ†éš”ï¼Œä¾‹å¦‚ï¼šçŸ¥è­˜é»1, çŸ¥è­˜é»2, çŸ¥è­˜é»3[39m
[31m+ </knowledge_points>[39m
[31m+[39m
[31m+ <requires_image>[39m
[31m+ åˆ¤æ–·é€™é“é¡Œæ˜¯å¦éœ€è¦ä¾è³´åœ–ç‰‡æ‰èƒ½æ­£ç¢ºè§£ç­”ã€‚å¦‚æœé¡Œç›®åŒ…å«å¹¾ä½•åœ–å½¢ã€å‡½æ•¸åœ–åƒã€å¯¦é©—è£ç½®åœ–ã€é›»è·¯åœ–ç­‰å¿…é ˆçœ‹åœ–æ‰èƒ½ç†è§£çš„å…§å®¹ï¼Œå¡«å¯« trueï¼›å¦‚æœåªéœ€è¦æ–‡å­—æè¿°å³å¯ç†è§£ï¼ˆå¦‚è‹±èªé¡Œã€ç´”æ–‡å­—æ•¸å­¸é¡Œï¼‰ï¼Œå¡«å¯« falseã€‚[39m
[31m+ </requires_image>[39m
[31m+[39m
[31m+ <question_text>[39m
[31m+ åœ¨æ­¤è™•å¡«å¯«é¡Œç›®çš„å®Œæ•´æ–‡æœ¬ã€‚ä½¿ç”¨ Markdown æ ¼å¼ã€‚æ‰€æœ‰æ•¸å­¸å…¬å¼ä½¿ç”¨ LaTeX ç¬¦è™Ÿï¼ˆè¡Œå…§ $...$ï¼Œå¡Šç´š $$...$$ï¼‰ã€‚[39m
[31m+ </question_text>[39m
[31m+[39m
[31m+ <answer_text>[39m
[31m+ åœ¨æ­¤è™•å¡«å¯«æ­£ç¢ºç­”æ¡ˆã€‚ä½¿ç”¨ Markdown å’Œ LaTeX ç¬¦è™Ÿã€‚[39m
[31m+ </answer_text>[39m
[31m+[39m
[31m+ <analysis>[39m
[31m+ åœ¨æ­¤è™•å¡«å¯«è©³ç´°çš„æ­¥é©Ÿè§£æã€‚[39m
[31m+ * å¿…é ˆä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼ˆå°ç£ï¼‰ã€‚[39m
[31m+ * **ç›´æ¥ä½¿ç”¨æ¨™æº–çš„ LaTeX ç¬¦è™Ÿ**ï¼ˆå¦‚ $rac{1}{2}$ï¼‰ï¼Œ**ä¸è¦**é€²è¡Œ JSON è·³è„«ï¼ˆä¸è¦å¯«æˆ \fracï¼‰ã€‚[39m
[31m+ </analysis>[39m
[31m+[39m
[31m+ ã€çŸ¥è­˜é»æ¨™ç±¤åˆ—è¡¨ï¼ˆKNOWLEDGE POINT LISTï¼‰ã€‘[39m
[31m+ **æ•¸å­¸æ¨™ç±¤ (Math Tags):**[39m
[31m+ ï¼ˆç„¡å¯ç”¨æ¨™ç±¤ï¼‰[39m
[31m+[39m
[31m+ **ç‰©ç†æ¨™ç±¤ (Physics Tags):**[39m
[31m+ ï¼ˆç„¡å¯ç”¨æ¨™ç±¤ï¼‰[39m
[31m+[39m
[31m+ **åŒ–å­¸æ¨™ç±¤ (Chemistry Tags):**[39m
[31m+ ï¼ˆç„¡å¯ç”¨æ¨™ç±¤ï¼‰[39m
[31m+[39m
[31m+ **ç”Ÿç‰©æ¨™ç±¤ (Biology Tags):**[39m
[31m+ ï¼ˆç„¡å¯ç”¨æ¨™ç±¤ï¼‰[39m
[31m+[39m
[31m+ **è‹±èªæ¨™ç±¤ (English Tags):**[39m
[31m+ ï¼ˆç„¡å¯ç”¨æ¨™ç±¤ï¼‰[39m
[31m+[39m
[31m+ ã€æ¨™ç±¤ä½¿ç”¨è¦å‰‡ (TAG RULES)ã€‘[39m
[31m+ - æ¨™ç±¤å¿…é ˆèˆ‡é¡Œç›®å¯¦éš›è€ƒæŸ¥çš„çŸ¥è­˜é»ç²¾æº–åŒ¹é…ã€‚[39m
[31m+ - æ¯é¡Œæœ€å¤š 5 å€‹æ¨™ç±¤ã€‚[39m
[31m+[39m
[31m+ ã€!!! é—œéµæ ¼å¼èˆ‡å…§å®¹ç´„æŸ (CRITICAL RULES) !!!ã€‘[39m
[31m+ 1. **æ ¼å¼åš´æ ¼**ï¼šå¿…é ˆåš´æ ¼åŒ…å«ä¸Šè¿° 6 å€‹ XML æ¨™ç±¤ï¼Œé™¤æ­¤ä¹‹å¤–ä¸è¦è¼¸å‡ºä»»ä½•å…¶ä»–â€œé–‹å ´ç™½â€æˆ–â€œçµæŸèªâ€ã€‚[39m
[31m+ 2. **ç´”æ–‡æœ¬**ï¼šå…§å®¹ä½œç‚ºç´”æ–‡æœ¬è™•ç†ï¼Œ**ä¸è¦è·³è„«åæ–œç·š**ã€‚[39m
[31m+ 3. **å…§å®¹å®Œæ•´**ï¼šå¦‚æœåŒ…å«å­å•é¡Œï¼Œè«‹åœ¨ question_text ä¸­å®Œæ•´åˆ—å‡ºã€‚[39m
[31m+ 4. **ç¦æ­¢åœ–ç‰‡**ï¼šåš´ç¦åŒ…å«ä»»ä½•åœ–ç‰‡é€£çµæˆ– markdown åœ–ç‰‡èªæ³•ã€‚[39m

[36m [2mâ¯[22m src/__tests__/unit/ai-prompts.test.ts:[2m49:28[22m[39m
    [90m 47| [39m        [34mit[39m([32m'åº”è¯¥åŒ…å«å­¦ç§‘æç¤ºï¼ˆå¦‚æœæä¾›ï¼‰'[39m[33m,[39m () [33m=>[39m {
    [90m 48| [39m            [35mconst[39m prompt [33m=[39m [34mgenerateAnalyzePrompt[39m([32m'zh'[39m[33m,[39m [35mnull[39m[33m,[39m [32m'æ•°å­¦'[39m)[33m;[39m
    [90m 49| [39m            [34mexpect[39m(prompt)[33m.[39m[34mtoContain[39m([32m'æ•°å­¦'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 50| [39m        })[33m;[39m
    [90m 51| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22måœ‹ä¸­éšæ®µ (junior_high)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹ä¸€ä¸Šå­¸æœŸï¼ˆ9æœˆå…¥å­¸ç•¶å¹´9æœˆï¼‰
[31m[1mAssertionError[22m: expected 'åœ‹ä¸€ä¸Š' to be 'åœ‹ä¸€ä¸Šå­¸æœŸ' // Object.is equality[39m

Expected: [32m"åœ‹ä¸€ä¸Š[7må­¸æœŸ[27m"[39m
Received: [31m"åœ‹ä¸€ä¸Š"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m13:28[22m[39m
    [90m 11| [39m            [90m// 2025å¹´9æœˆå…¥å­¸ï¼Œ2025å¹´9æœˆæŸ¥è©¢[39m
    [90m 12| [39m            const result = calculateGrade('junior_high', 2025, new Datâ€¦
    [90m 13| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'åœ‹ä¸€ä¸Šå­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 14| [39m        })[33m;[39m
    [90m 15| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22måœ‹ä¸­éšæ®µ (junior_high)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹ä¸€ä¸‹å­¸æœŸï¼ˆæ¬¡å¹´2æœˆï¼‰
[31m[1mAssertionError[22m: expected 'åœ‹ä¸€ä¸‹' to be 'åœ‹ä¸€ä¸‹å­¸æœŸ' // Object.is equality[39m

Expected: [32m"åœ‹ä¸€ä¸‹[7må­¸æœŸ[27m"[39m
Received: [31m"åœ‹ä¸€ä¸‹"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m24:28[22m[39m
    [90m 22| [39m            [90m// 2025å¹´9æœˆå…¥å­¸ï¼Œ2026å¹´3æœˆæŸ¥è©¢[39m
    [90m 23| [39m            const result = calculateGrade('junior_high', 2025, new Datâ€¦
    [90m 24| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'åœ‹ä¸€ä¸‹å­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 25| [39m        })[33m;[39m
    [90m 26| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22måœ‹ä¸­éšæ®µ (junior_high)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹äºŒä¸Šå­¸æœŸ
[31m[1mAssertionError[22m: expected 'åœ‹äºŒä¸Š' to be 'åœ‹äºŒä¸Šå­¸æœŸ' // Object.is equality[39m

Expected: [32m"åœ‹äºŒä¸Š[7må­¸æœŸ[27m"[39m
Received: [31m"åœ‹äºŒä¸Š"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m30:28[22m[39m
    [90m 28| [39m            [90m// 2024å¹´9æœˆå…¥å­¸ï¼Œ2025å¹´10æœˆæŸ¥è©¢[39m
    [90m 29| [39m            const result = calculateGrade('junior_high', 2024, new Datâ€¦
    [90m 30| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'åœ‹äºŒä¸Šå­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 31| [39m        })[33m;[39m
    [90m 32| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22måœ‹ä¸­éšæ®µ (junior_high)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—åœ‹ä¸‰ä¸‹å­¸æœŸ
[31m[1mAssertionError[22m: expected 'åœ‹ä¸‰ä¸‹' to be 'åœ‹ä¸‰ä¸‹å­¸æœŸ' // Object.is equality[39m

Expected: [32m"åœ‹ä¸‰ä¸‹[7må­¸æœŸ[27m"[39m
Received: [31m"åœ‹ä¸‰ä¸‹"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m36:28[22m[39m
    [90m 34| [39m            [90m// 2022å¹´9æœˆå…¥å­¸ï¼Œ2025å¹´5æœˆæŸ¥è©¢[39m
    [90m 35| [39m            const result = calculateGrade('junior_high', 2022, new Datâ€¦
    [90m 36| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'åœ‹ä¸‰ä¸‹å­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 37| [39m        })[33m;[39m
    [90m 38| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22måœ‹ä¸­éšæ®µ (junior_high)[2m > [22mæ‡‰è©²æ­£ç¢ºè™•ç†å·²ç•¢æ¥­æƒ…æ³
[31m[1mAssertionError[22m: expected 'å·²ç•¢æ¥­ä¸Š' to be 'å·²ç•¢æ¥­ä¸Šå­¸æœŸ' // Object.is equality[39m

Expected: [32m"å·²ç•¢æ¥­ä¸Š[7må­¸æœŸ[27m"[39m
Received: [31m"å·²ç•¢æ¥­ä¸Š"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m42:28[22m[39m
    [90m 40| [39m            [90m// 2020å¹´9æœˆå…¥å­¸ï¼Œ2024å¹´æŸ¥è©¢ï¼ˆå·²è¶…é3å¹´ï¼‰[39m
    [90m 41| [39m            const result = calculateGrade('junior_high', 2020, new Datâ€¦
    [90m 42| [39m            expect(result).toBe('å·²ç•¢æ¥­ä¸Šå­¸æœŸ'); // æ³¨æ„ï¼šgrade-calculator.ts å¯â€¦
    [90m   | [39m                           [31m^[39m
    [90m 43| [39m        })[33m;[39m
    [90m 44| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[6/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22mé«˜ä¸­éšæ®µ (senior_high)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—é«˜ä¸€ä¸Šå­¸æœŸ
[31m[1mAssertionError[22m: expected 'é«˜ä¸€ä¸Š' to be 'é«˜ä¸€ä¸Šå­¸æœŸ' // Object.is equality[39m

Expected: [32m"é«˜ä¸€ä¸Š[7må­¸æœŸ[27m"[39m
Received: [31m"é«˜ä¸€ä¸Š"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m54:28[22m[39m
    [90m 52| [39m        [34mit[39m([32m'æ‡‰è©²æ­£ç¢ºè¨ˆç®—é«˜ä¸€ä¸Šå­¸æœŸ'[39m[33m,[39m () [33m=>[39m {
    [90m 53| [39m            const result = calculateGrade('senior_high', 2024, new Datâ€¦
    [90m 54| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'é«˜ä¸€ä¸Šå­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 55| [39m        })[33m;[39m
    [90m 56| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[7/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22mé«˜ä¸­éšæ®µ (senior_high)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—é«˜äºŒä¸‹å­¸æœŸ
[31m[1mAssertionError[22m: expected 'é«˜äºŒä¸‹' to be 'é«˜äºŒä¸‹å­¸æœŸ' // Object.is equality[39m

Expected: [32m"é«˜äºŒä¸‹[7må­¸æœŸ[27m"[39m
Received: [31m"é«˜äºŒä¸‹"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m59:28[22m[39m
    [90m 57| [39m        [34mit[39m([32m'æ‡‰è©²æ­£ç¢ºè¨ˆç®—é«˜äºŒä¸‹å­¸æœŸ'[39m[33m,[39m () [33m=>[39m {
    [90m 58| [39m            const result = calculateGrade('senior_high', 2023, new Datâ€¦
    [90m 59| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'é«˜äºŒä¸‹å­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 60| [39m        })[33m;[39m
    [90m 61| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[8/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22måœ‹å°éšæ®µ (primary)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—ä¸€å¹´ç´š
[31m[1mAssertionError[22m: expected 'ä¸€å¹´ç´šä¸Š' to be 'ä¸€å¹´ç´šä¸Šå­¸æœŸ' // Object.is equality[39m

Expected: [32m"ä¸€å¹´ç´šä¸Š[7må­¸æœŸ[27m"[39m
Received: [31m"ä¸€å¹´ç´šä¸Š"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m71:28[22m[39m
    [90m 69| [39m        [34mit[39m([32m'æ‡‰è©²æ­£ç¢ºè¨ˆç®—ä¸€å¹´ç´š'[39m[33m,[39m () [33m=>[39m {
    [90m 70| [39m            const result = calculateGrade('primary', 2024, new Date('2â€¦
    [90m 71| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'ä¸€å¹´ç´šä¸Šå­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 72| [39m        })[33m;[39m
    [90m 73| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[9/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22måœ‹å°éšæ®µ (primary)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—å…­å¹´ç´š
[31m[1mAssertionError[22m: expected 'å…­å¹´ç´šä¸‹' to be 'å…­å¹´ç´šä¸‹å­¸æœŸ' // Object.is equality[39m

Expected: [32m"å…­å¹´ç´šä¸‹[7må­¸æœŸ[27m"[39m
Received: [31m"å…­å¹´ç´šä¸‹"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m76:28[22m[39m
    [90m 74| [39m        [34mit[39m([32m'æ‡‰è©²æ­£ç¢ºè¨ˆç®—å…­å¹´ç´š'[39m[33m,[39m () [33m=>[39m {
    [90m 75| [39m            const result = calculateGrade('primary', 2019, new Date('2â€¦
    [90m 76| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'å…­å¹´ç´šä¸‹å­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 77| [39m        })[33m;[39m
    [90m 78| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[10/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/grade-calculator.test.ts[2m > [22mcalculateGrade[2m > [22må¤§å­¸éšæ®µ (university)[2m > [22mæ‡‰è©²æ­£ç¢ºè¨ˆç®—å¤§ä¸€
[31m[1mAssertionError[22m: expected 'å¤§ä¸€ä¸Š' to be 'å¤§ä¸€ä¸Šå­¸æœŸ' // Object.is equality[39m

Expected: [32m"å¤§ä¸€ä¸Š[7må­¸æœŸ[27m"[39m
Received: [31m"å¤§ä¸€ä¸Š"[39m

[36m [2mâ¯[22m src/__tests__/unit/grade-calculator.test.ts:[2m88:28[22m[39m
    [90m 86| [39m        [34mit[39m([32m'æ‡‰è©²æ­£ç¢ºè¨ˆç®—å¤§ä¸€'[39m[33m,[39m () [33m=>[39m {
    [90m 87| [39m            const result = calculateGrade('university', 2024, new Dateâ€¦
    [90m 88| [39m            [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m'å¤§ä¸€ä¸Šå­¸æœŸ'[39m)[33m;[39m
    [90m   | [39m                           [31m^[39m
    [90m 89| [39m        })[33m;[39m
    [90m 90| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[11/12]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/unit/ai/azure-provider.test.ts[2m > [22mAzure OpenAI Provider å“åº”è§£æ[2m > [22mparseResponse[2m > [22måº”è¯¥æ­£ç¡®è§£æåŒ…å«æ‰€æœ‰å¿…éœ€æ ‡ç­¾çš„å“åº”
[31m[1mAssertionError[22m: expected 'å…¶ä»–' to be 'æ•°å­¦' // Object.is equality[39m

Expected: [32m"æ•°å­¦"[39m
Received: [31m"å…¶ä»–"[39m

[36m [2mâ¯[22m src/__tests__/unit/ai/azure-provider.test.ts:[2m234:36[22m[39m
    [90m232| [39m            [34mexpect[39m(result[33m.[39manswerText)[33m.[39m[34mtoBe[39m([32m'æœ€å°å€¼ä¸º 0'[39m)[33m;[39m
    [90m233| [39m            [34mexpect[39m(result[33m.[39manalysis)[33m.[39m[34mtoContain[39m([32m'äºŒæ¬¡å‡½æ•°'[39m)[33m;[39m
    [90m234| [39m            [34mexpect[39m(result[33m.[39msubject)[33m.[39m[34mtoBe[39m([32m'æ•°å­¦'[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m235| [39m            [34mexpect[39m(result[33m.[39mknowledgePoints)[33m.[39m[34mtoContain[39m([32m'äºŒæ¬¡å‡½æ•°'[39m)[33m;[39m
    [90m236| [39m            [34mexpect[39m(result[33m.[39mknowledgePoints)[33m.[39m[34mtoContain[39m([32m'å‡½æ•°æœ€å€¼'[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[12/12]â¯[22m[39m


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m20 passed[39m[22m[90m (23)[39m
[2m      Tests [22m [1m[31m12 failed[39m[22m[2m | [22m[1m[32m375 passed[39m[22m[90m (387)[39m
[2m   Start at [22m 11:26:53
[2m   Duration [22m 15.89s[2m (transform 2.76s, setup 632ms, import 5.93s, tests 13.07s, environment 70.18s)[22m

