# Markdown + 數學公式支援功能說明

## ✅ 已實現功能

### 1. **安裝的相依套件**
```json
{
  "react-markdown": "支援 Markdown 渲染",
  "remark-math": "解析數學公式",
  "remark-gfm": "支援 GitHub 風格 Markdown（表格、刪除線等）",
  "rehype-katex": "渲染 LaTeX 數學公式",
  "katex": "KaTeX 核心庫"
}
```

### 2. **創建的組件**
- **MarkdownRenderer** (`/src/components/markdown-renderer.tsx`)
  - 自動渲染 Markdown 內容
  - 支援數學公式（LaTeX）
  - 自定義樣式（標題、列表、表格、程式碼區塊等）

### 3. **更新的 AI Prompt**
AI 現在會生成包含 Markdown 格式的內容：
- 使用 Markdown 標題、列表、粗體等格式
- 數學公式使用 LaTeX 格式：
  - 行內公式：`$x^2 + 2x + 1$`
  - 區塊公式：`$$\int_{0}^{1} f(x)dx$$`

### 4. **應用範圍**
- ✅ 錯題詳情頁（題目、答案、解析）
- ✅ 練習頁面（題目、答案、解析）

## 📖 Markdown 功能範例

### 數學公式

**行內公式：**
```markdown
方程 $x^2 + 2x + 1 = 0$ 的解為 $x = -1$
```

**區塊公式：**
```markdown
求根公式：
$$
x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
$$
```

### 文字格式

```markdown
## 解題思路

這是一道**二次方程**問題。

步驟：
1. 識別係數 $a$, $b$, $c$
2. 計算判別式 $\Delta = b^2 - 4ac$
3. 應用求根公式

**注意**：當 $\Delta = 0$ 時，方程有*重根*。
```

### 表格

```markdown
| 係數 | 值 |
|------|-----|
| a    | 1   |
| b    | 2   |
| c    | 1   |
```

### 程式碼區塊

```markdown
計算過程：
\`\`\`
Δ = b² - 4ac
  = 2² - 4(1)(1)
  = 4 - 4
  = 0
\`\`\`
```

## 🎨 樣式效果

### 標題層級
- `# H1` - 大標題
- `## H2` - 章節標題  
- `### H3` - 小節標題

### 列表
- 無序列表：`-` 或 `*`
- 有序列表：`1.`, `2.`, ...

### 強調
- **粗體**：`**文本**`
- *斜體*：`*文本*`
- `代碼`：`` `代碼` ``

### 引用
```markdown
> 這是一條引用
```

## 🔧 AI 生成範例

當 AI 分析題目後，會生成類似這樣的內容：

```json
{
  "questionText": "求解方程 $x^2 + 2x + 1 = 0$",
  "answerText": "$x = -1$（重根）",
  "analysis": "## 解題步驟\n\n這是一道**完全平方式**問題。\n\n### 方法一：配方法\n\n原式可以配方為：\n$$x^2 + 2x + 1 = (x+1)^2 = 0$$\n\n因此：$x + 1 = 0$，即 $x = -1$\n\n### 方法二：求根公式\n\n使用求根公式：\n$$x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n\n代入 $a=1$, $b=2$, $c=1$：\n- 判別式：$\\Delta = 4 - 4 = 0$\n- 所以：$x = \\frac{-2}{2} = -1$\n\n**結論**：方程有重根 $x = -1$"
}
```

## ⚡ 使用建議

### 對於簡單題目
AI 可以使用簡潔的 Markdown：
```markdown
這道題考查基本運算。

答案是 $42$。
```

### 對於複雜題目
AI 可以使用完整的 Markdown 格式：
```markdown
## 解題思路

### 第一步：分析題意
根據題目，我們需要...

### 第二步：建立方程
設未知數為 $x$，則：
$$
\begin{cases}
2x + y = 5 \\
x - y = 1
\end{cases}
$$

### 第三步：求解
使用**消元法**...
```

## 📝 注意事項

1. **數學公式格式**
   - 行內：`$公式$`
   - 區塊：`$$公式$$`
   - 特殊字元需跳脫：`\\frac`, `\\sqrt`

2. **換行**
   - Markdown 中兩個空格 + 回車 = 換行
   - 空行 = 新段落

3. **程式碼區塊**
   - 三個反引號：`` ``` ``
   - 可指定語言：`` ```python ``

## 🎯 下一步

現在上傳新的錯題或生成練習題時，AI 會自動使用 Markdown 格式！

已有的舊數據仍然會正常顯示（作為純文字），新數據將享受完整的格式化支援。
